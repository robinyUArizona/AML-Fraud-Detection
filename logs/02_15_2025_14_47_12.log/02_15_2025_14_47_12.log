[ 2025-02-15 14:47:13,794] 23 root - INFO - Entered the 'data ingestion' method or component
[ 2025-02-15 14:47:13,795] 29 root - INFO - CSV File Path:, /Users/robins/Desktop/Robins World/Data Science - Machine Learning Prep/01 - MLOps/AML-Fraud-Detection/notebook/data/HI-Small_Trans.csv
[ 2025-02-15 14:47:13,795] 33 root - INFO - File found: /Users/robins/Desktop/Robins World/Data Science - Machine Learning Prep/01 - MLOps/AML-Fraud-Detection/notebook/data/HI-Small_Trans.csv
[ 2025-02-15 14:47:16,398] 40 root - INFO - Read the dataset as DataFrame
[ 2025-02-15 14:47:16,486] 46 root - INFO - Train Test split initiated
[ 2025-02-15 14:47:16,576] 50 root - INFO - Ingestion of the data completed
[ 2025-02-15 14:47:16,658] 68 root - INFO - 
Entered the 'data transformation' method or component
[ 2025-02-15 14:47:16,695] 72 root - INFO - Reading train and test data completed
[ 2025-02-15 14:47:16,696] 76 root - INFO - Train and Test dataframe columns name renamed
[ 2025-02-15 14:47:16,698] 78 root - INFO - Train Dataframe Head : 
          timestamp  from_bank    account  to_bank  account_1  amount_received receiving_currency   amount_paid payment_currency payment_format  is_laundering
0  2022/09/02 11:26     353132  814282F31   255063  814282BC1          0.02664            Bitcoin       0.02664          Bitcoin        Bitcoin              0
1  2022/09/02 04:29      29003  80B58DFD0   123390  80EC2ACA0      91604.31000          US Dollar   91604.31000        US Dollar            ACH              0
2  2022/09/10 01:30     143430  810A32FA0   244192  811917200       2145.51000             Shekel    2145.51000           Shekel         Cheque              0
3  2022/09/07 21:25      16678  806484950    17554  806AAFE90     108457.21000              Ruble  108457.21000            Ruble         Cheque              0
4  2022/09/02 06:22        210  809181590    24779  80924A880       7577.02000    Canadian Dollar    7577.02000  Canadian Dollar    Credit Card              0
[ 2025-02-15 14:47:16,698] 79 root - INFO - Test Dataframe Head : 
          timestamp  from_bank    account  to_bank  account_1  amount_received receiving_currency  amount_paid payment_currency payment_format  is_laundering
0  2022/09/09 19:26      33727  80C66DAE0    33727  80C66DAE0         16515.55          US Dollar    349189.96     Mexican Peso            ACH              0
1  2022/09/08 18:24      28694  8036FA390   122151  80BDB1470           169.14          US Dollar       169.14        US Dollar           Cash              0
2  2022/09/05 16:06         70  1004286A8    13057  80189B650         19878.41               Euro     19878.41             Euro    Credit Card              0
3  2022/09/06 15:53          9  8060A15C0        9  8060B3140          8390.38              Ruble      8390.38            Ruble           Cash              0
4  2022/09/09 19:12       1853  801449850    17729  808FBDE10            98.92          US Dollar        98.92        US Dollar         Cheque              0
[ 2025-02-15 14:47:16,717] 104 root - INFO - Columns name of numerical features: ['from_bank', 'to_bank', 'amount_received']
[ 2025-02-15 14:47:16,718] 106 root - INFO - Columns name of categorical features: ['account', 'account_1', 'receiving_currency', 'payment_currency', 'payment_format', 'day']
[ 2025-02-15 14:47:16,718] 108 root - INFO - Obtaining proprocessing object
[ 2025-02-15 14:47:16,718] 59 root - INFO - Preprocessed both numerical and categorical columns
[ 2025-02-15 14:47:16,718] 111 root - INFO - Applying preprocessing object on training and testing datasets.
[ 2025-02-15 14:47:16,952] 125 root - INFO - Saved data preprocessing object
[ 2025-02-15 14:47:16,958] 27 root - INFO - Get Independent features and Dependent feature from Train and Test datasets
[ 2025-02-15 14:47:16,958] 35 root - INFO - Imbalance dataset - upsampling the train data
[ 2025-02-15 14:47:16,963] 46 root - INFO - Before SMOTE: Counter({np.float64(0.0): 39959, np.float64(1.0): 41})
[ 2025-02-15 14:47:17,011] 48 root - INFO - After SMOTE: Counter({np.float64(0.0): 39959, np.float64(1.0): 39959})
[ 2025-02-15 14:47:17,011] 49 root - INFO - Upsampling the minority class data completed
[ 2025-02-15 14:47:17,012] 81 root - INFO - Grid Search started for RandomForestClassifier()
[ 2025-02-15 14:47:38,801] 85 root - INFO - Grid Search completed for RandomForestClassifier()
[ 2025-02-15 14:47:38,802] 88 root - INFO - Best parameters: {'n_estimators': 200} for RandomForestClassifier()
[ 2025-02-15 14:47:49,690] 98 root - INFO - Obtaining evaluation metrics for RandomForestClassifier(n_estimators=200) by using best hyperparameters
[ 2025-02-15 14:47:49,711] 81 root - INFO - Grid Search started for AdaBoostClassifier()
[ 2025-02-15 14:48:31,857] 85 root - INFO - Grid Search completed for AdaBoostClassifier()
[ 2025-02-15 14:48:31,858] 88 root - INFO - Best parameters: {'learning_rate': 1.0, 'n_estimators': 200} for AdaBoostClassifier()
[ 2025-02-15 14:48:41,924] 98 root - INFO - Obtaining evaluation metrics for AdaBoostClassifier(n_estimators=200) by using best hyperparameters
[ 2025-02-15 14:48:41,946] 81 root - INFO - Grid Search started for XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, device=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, feature_types=None,
              gamma=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_threshold=None, max_cat_to_onehot=None,
              max_delta_step=None, max_depth=None, max_leaves=None,
              min_child_weight=None, missing=nan, monotone_constraints=None,
              multi_strategy=None, n_estimators=None, n_jobs=None,
              num_parallel_tree=None, random_state=None, ...)
[ 2025-02-15 14:48:45,476] 85 root - INFO - Grid Search completed for XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, device=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, feature_types=None,
              gamma=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_threshold=None, max_cat_to_onehot=None,
              max_delta_step=None, max_depth=None, max_leaves=None,
              min_child_weight=None, missing=nan, monotone_constraints=None,
              multi_strategy=None, n_estimators=None, n_jobs=None,
              num_parallel_tree=None, random_state=None, ...)
[ 2025-02-15 14:48:45,477] 88 root - INFO - Best parameters: {'learning_rate': 0.1, 'n_estimators': 200} for XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, device=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, feature_types=None,
              gamma=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=None, max_bin=None,
              max_cat_threshold=None, max_cat_to_onehot=None,
              max_delta_step=None, max_depth=None, max_leaves=None,
              min_child_weight=None, missing=nan, monotone_constraints=None,
              multi_strategy=None, n_estimators=None, n_jobs=None,
              num_parallel_tree=None, random_state=None, ...)
[ 2025-02-15 14:48:46,066] 98 root - INFO - Obtaining evaluation metrics for XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, device=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, feature_types=None,
              gamma=None, grow_policy=None, importance_type=None,
              interaction_constraints=None, learning_rate=0.1, max_bin=None,
              max_cat_threshold=None, max_cat_to_onehot=None,
              max_delta_step=None, max_depth=None, max_leaves=None,
              min_child_weight=None, missing=nan, monotone_constraints=None,
              multi_strategy=None, n_estimators=200, n_jobs=None,
              num_parallel_tree=None, random_state=None, ...) by using best hyperparameters
[ 2025-02-15 14:48:46,079] 119 root - INFO - 
 Metrics calculation on Train Data: 
{'Random Forest': [{'Precision': 1.0, 'Recall': 1.0, 'F1 score': 1.0, 'Confusion Matrix': array([[39959,     0],
       [    0, 39959]])}], 'AdaBoost': [{'Precision': 0.9869974214999089, 'Recall': 0.9866613278610575, 'F1 score': 0.9866635697592298, 'Confusion Matrix': array([[38908,    15],
       [ 1051, 39944]])}], 'XGBoost': [{'Precision': 0.9996373237697647, 'Recall': 0.9996371280562577, 'F1 score': 0.9996371280917673, 'Confusion Matrix': array([[39932,     2],
       [   27, 39957]])}]}
[ 2025-02-15 14:48:46,079] 121 root - INFO - 
 Metrics calculation on Test Data: 
{'Random Forest': [{'Precision': 0.9985995794532894, 'Recall': 0.998, 'F1 score': 0.9982996996996997, 'Confusion Matrix': array([[9980,   13],
       [   7,    0]])}], 'AdaBoost': [{'Precision': 0.9488484645423667, 'Recall': 0.9685, 'F1 score': 0.9542555286452052, 'Confusion Matrix': array([[9681,    9],
       [ 306,    4]])}], 'XGBoost': [{'Precision': 0.9958016821868428, 'Recall': 0.9966, 'F1 score': 0.9962006811579686, 'Confusion Matrix': array([[9966,   13],
       [  21,    0]])}]}
[ 2025-02-15 14:48:46,079] 89 root - INFO - The models and their corresponding Recall score: 
{'Random Forest': 0.998, 'AdaBoost': 0.9685, 'XGBoost': 0.9966}
[ 2025-02-15 14:48:46,079] 93 root - INFO - Best Model: Random Forest with Recall score: 0.998
[ 2025-02-15 14:48:46,157] 108 root - INFO - Model Training completed
[ 2025-02-15 14:48:46,157] 109 root - INFO - Final Recall score for the RandomForestClassifier(n_estimators=200): 0.998
